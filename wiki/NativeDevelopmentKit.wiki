#summary Howto use the android-maven-plugin to create native libraries.
#labels NDK,HowTo

= Introduction =

== Setup Environment ==

Set the `ANDROID_NDK_HOME` the the root directory of your NDK installation. Example (Windows):

{{{
SET ANDROID_NDK_HOME=C:\opt\android-ndk-r7b
}}}

== Setup pom.xml ==

The following instructions apply to the setup of a apk with a native library. For the creation and use of libraries see NativeLibsAsDependencies.

=== Cleanup ===

The NDK does not compile into the `target` directory but into `obj` and `libs` so they need to be cleaned as well:

{{{
      <plugin>
        <artifactId>maven-clean-plugin</artifactId>
        <configuration>
          <filesets>
            <fileset>
              <directory>libs</directory>
            </fileset>
            <fileset>
              <directory>obj</directory>
            </fileset>
          </filesets>
        </configuration>
      </plugin>
}}}

=== Build Setup ===

Native buuld is activated by the `ndk-build` goal. Also the plugin need to know the location of the NDK installation.

{{{
      <plugin>
        <groupId>com.jayway.maven.plugins.android.generation2</groupId>
        <artifactId>android-maven-plugin</artifactId>
        <goals>
          <goal>ndk-build</goal>
        </goals>
        <configuration>
          <ndk>
            <path>${env.ANDROID_NDK_HOME}</path>
          </ndk>
        </configuration>
        <extensions>true</extensions>
      </plugin>
}}}

== Execute Build ==

Use the following two command to build (you need to set the pluginGroup as described in TipsAndTricks):

{{{
mvn android:ndk-build
mvn install
}}}