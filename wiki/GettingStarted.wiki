#summary Get started using Maven Android Plugin
#labels Featured

Documentation in book form is available with the Android chapter of the free book
Maven: The complete Reference in HTML and PDF format:
http://www.sonatype.com/books/mvnref-book/reference/android-dev.html

= Getting Started =

== Prerequisites ==

 # JDK 1.5+ installed as required for Android development
 # Android SDK (2.0.1) installed, preferably with all platforms, see http://developer.android.com/sdk/index.html
 # Maven 2.2.1+ installed , see http://maven.apache.org/download.html

== Setup your development environment ==
  # Set environment variable ANDROID_HOME to the path of your installed Android SDK and add $ANDROID_HOME/tools to your $PATH.
  # Download the maven-android-sdk-deployer from http://github.com/mosabua/maven-android-sdk-deployer/archives/master , extract the file to any folder and follow the instructions in the README file.
  # If you look in the pom.xml of the samples`*` project you will find the following dependency.

{{{
  <dependency>
    <groupId>android</groupId>
    <artifactId>android</artifactId>
    <version>1.5_r3</version>
    <scope>provided</scope>
  </dependency>
}}}

The currently valid dependencies are:

{{{
          <dependency>
              <groupId>android</groupId>
              <artifactId>android</artifactId>
              <version>1.1_r1</version>
              <scope>provided</scope>
          </dependency>

          <dependency>
              <groupId>android</groupId>
              <artifactId>android</artifactId>
              <version>1.5_r3</version>
              <scope>provided</scope>
          </dependency>

          <dependency>
              <groupId>android</groupId>
              <artifactId>android</artifactId>
              <version>1.6_r2</version>
              <scope>provided</scope>
          </dependency>

          <dependency>
              <groupId>android</groupId>
              <artifactId>android</artifactId>
              <version>2.0_r1</version>
              <scope>provided</scope>
          </dependency>

          <dependency>
              <groupId>android</groupId>
              <artifactId>android</artifactId>
              <version>2.0.1_r1</version>
              <scope>provided</scope>
          </dependency>

          <dependency>
              <groupId>android</groupId>
              <artifactId>android</artifactId>
              <version>2.1_r1</version>
              <scope>provided</scope>
          </dependency>

}}}

Use one these depending on the platform version you are developing against.

== Optional: Test your development environment ==

If you want to test your environment, download and run the [Samples]`*`.

== Create your own Android application (apk) ==
<ol>
  <li>Create a project using the {{{android}}} tool:</li>
     * http://developer.android.com/guide/developing/other-ide.html#CreatingAProject
  <li>Create a {{{pom.xml}}} in your project, using the sample {{{apidemos-15/apidemos-15-app/pom.xml}}} as template. (See [Samples]`*`.)</li>
     * Make these changes:
     * Remove the entire {{{<parent>}}} tag.
     * Change {{{<groupId>}}}, {{{<artifactId>}}} and {{{<name>}}} to your own. (Some tips: [http://maven.apache.org/guides/mini/guide-naming-conventions.html Maven - Guide to Naming Conventions])
  <li>Rename, and move the source directory to where Maven expects it:</li>
     {{{
     mv src java
     mkdir -p src/main
     mv java src/main/
     }}}

     or if you don't want to change the directory structure, just add "sourceDirectory
{{{
    <build>
    ......
    <sourceDirectory>src</sourceDirectory> 
    </build>
}}} 

     to pom.xml.

  <li>You won't need these files/directories with Maven Android Plugin, so you can remove them:</li>
     {{{
     rm -r bin build.xml build.properties libs
     }}}
     _The {{{default.properties}}} file is currently not used by Maven Android Plugin, but will be, so leave that in place for now. {{{default.properties}}} and the {{{gen}}} folder are used by the ADT plugin in Eclipse, if you use that._<br/>
     _(Also leave the "test" folder for now. You can later move it out to its own project. If you want, you can then look at the {{{apidemos-15-instrumentationtest}}} sample project.)_
  <li>To build your apk, simply:</li>
     {{{
     mvn install
     }}}
  <li>To deploy your apk to the connected device:</li>
     {{{
     mvn com.jayway.maven.plugins.android.generation2:maven-android-plugin:deploy
     }}}

<sup><i>Do you think that last Maven command was long? It was. Check out [TipsAndTricks].</i></sup>

</ol>

Notes:

 # Do not put tests in {{{src/test/java}}} that you want to be run by the Maven Android plugin. If you put your tests there, Maven runs them as normal JUnit tests in the JVM, with the JAR files that are accessible on the classpath, which includes the android.jar. Because the android.jar only contains empty methods that throw exceptions, you get exceptions of the form {{{java.lang.RuntimeException: Stub!}}}. Instead, the tests need to go in {{{src/main/java}}}, where they will not be run by Maven as tests during compilation, but will be included in the apk and deployed and run on the device (where the android.jar has method implementations instead of stubs).
 # If you have JUnit tests that don't call any Android APIs (directly or transitively), put them in {{{src/test/java}}} so JUnit runs them locally and more quickly than if run on the device.
 # Make sure the Maven Android goal is set to {{{<goal>jar-no-fork</goal>}}} instead of {{{<goal>test-jar-no-fork</goal>}}}. Do this even for projects that only contain tests.

== Run instrumentation tests on device ==
Check out the {{{apidemos-15-instrumentationtest}}} project in [Samples]`*`.

You can create a project like that, by moving your "test" folder out and renaming it to for example "myproject-instrumentationtest". Then rearrange the folders within it like above, and use the {{{pom.xml}}} from {{{apidemos-15-instrumentationtest}}} as template.
  
== More documentation ==

There is some more documentation on the [Documentation] page.
<br/>
=== (`*`) Samples===
Always use the version of samples linked from the [Samples] page, so that you get a usable version of its configuration.
<br/>
<br/>
----
_Please feel free to update this page with more details / corrections! (Just ask hugo@josefson.org for edit permissions, and you will get it.)_